import{r as e,a as t,_ as a,b as l,c as n}from"./all_app-DM1_li4y.js";import{_ as o}from"./ai_icon-DLM4MVGS.js";import{d as i,u as s,a as r}from"./index-CFoqAggZ.js";import{aa as c,ab as d,bz as p,v as u,r as g,u as m,D as v,c as f,a9 as y,ac as k,ad as w,ae as b,d as x,af as h,e as D,ah as L,F as M,L as C,ag as _,aj as T,ai as B,ak as Q,bH as H,bI as P,t as z,cp as I,cq as N,C as R,s as U,bJ as W,bG as A}from"./apis-pJ_f7Wei.js";import{s as O,v as j,y as V,C as S}from"./hooks-B5UyGDFK.js";import{c as K,d as F,l as J,B as Z,R as q,n as $}from"./naive-ui-BEvmpK0i.js";import{b as E,r as G,a as X}from"./format-Bqzcy7BU.js";import{p as Y}from"./pako-DsGp7kFX.js";import{r as ee,a as te,b as ae,c as le,d as ne,e as oe}from"./FunnelIcon-CQpzXPqw.js";import"./iconfont-AVbwqJow.js";import"./lodash-DMrPhC4V.js";function ie(e,t){return c(),d("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[p("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 8.25V18a2.25 2.25 0 0 0 2.25 2.25h13.5A2.25 2.25 0 0 0 21 18V8.25m-18 0V6a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 6v2.25m-18 0h18M5.25 6h.008v.008H5.25V6ZM7.5 6h.008v.008H7.5V6Zm2.25 0h.008v.008H9.75V6Z"})])}const se=u({__name:"DotBlackListAppDrawer",props:{type:{},title:{}},emits:["submit"],setup(e,{expose:t,emit:a}){const l=i();g(null),g(null);const n=e,o=g(!1),s=m();O(),v();const r=f((()=>({theme:s.isDarkMode?F:J}))),{message:p,modal:u}=K(["message","modal"],{configProviderProps:r});let C,_;const T=g({openDrawer:e=>new Promise(((t,a)=>{if("update"===n.type&&!e)return a(new Error("更新模式下必须传入初始化参数")),void p.error("初始化参数不能为空");C=t,_=a,B.value="",o.value=!0})),closeDrawer:()=>{o.value=!1,_("Drawer closed without submission")}}),B=g(""),Q=g(""),H=g(!1);return t({openDrawer:T.value.openDrawer}),(e,t)=>{const a=y("n-input-group-label"),i=y("n-input"),r=y("n-input-group"),p=y("n-alert"),g=y("n-button"),m=y("n-drawer-content"),v=y("n-drawer");return c(),d(M,null,[k(e.$slots,"default",w(b({openDrawer:T.value.openDrawer}))),x(v,{show:o.value,"onUpdate:show":t[3]||(t[3]=e=>o.value=e),width:L(s).windowWidth>=640?"450px":"100%",placement:"right"},{default:h((()=>[x(m,{"body-content-class":"auto-ui-drawer-content","scrollbar-props":{trigger:"none"},title:n.title,closable:""},{footer:h((()=>[x(g,{type:"info",loading:H.value,"onUpdate:loading":t[1]||(t[1]=e=>H.value=e),onClick:t[2]||(t[2]=()=>(async()=>{if(!B.value)return void u.create({title:"应用包名不能为空",type:"error",preset:"dialog",content:()=>x("p",null,[D("噫？应用包名不能为空（敲")])});if(l.allPackageName.has(B.value))return void u.create({title:"应用包名已存在",type:"error",preset:"dialog",content:()=>x("p",null,[D("噫？这个应用包名已经存在列表中了（敲")])});H.value=!0;const e=()=>{H.value=!1},t={name:B.value,loadingCallback:e,closeCallback:()=>{H.value=!1,o.value=!1}};u.create({title:"确认隐藏窗口控制器吗？",type:"warning",preset:"dialog",content:()=>x("p",null,[D("窗口控制器的隐藏受小米云控规则下发影响，如果隐藏窗口控制器失效，请重新操作")," ",x("span",{class:"font-bold "+(s.isDarkMode?"text-teal-400":"text-gray-600")},[D("热重载应用数据")])," ",D("，如后续需要恢复")," ",x("span",{class:"font-bold "+(s.isDarkMode?"text-teal-400":"text-gray-600")},[D("窗口控制器")])," ",D("的显示，则需要先清除自定义规则，确定要继续吗？")]),positiveText:"确定隐藏",negativeText:"我再想想",onPositiveClick:async()=>{C(t)},onNegativeClick(){e()},onMaskClick(){e()},onClose(){e()}})})())},{default:h((()=>t[6]||(t[6]=[D(" 提交 ")]))),_:1},8,["loading"])])),default:h((()=>[x(r,null,{default:h((()=>[x(a,{size:"large"},{default:h((()=>t[4]||(t[4]=[D("应用包名")]))),_:1}),x(i,{size:"large",status:Q.value,value:B.value,"onUpdate:value":t[0]||(t[0]=e=>B.value=e),"allow-input":e=>j(e),readonly:"update"===n.type,placeholder:"请输入应用包名"},null,8,["status","value","allow-input","readonly"])])),_:1}),x(p,{"show-icon":!1,bordered:!1,title:"隐藏窗口控制器",type:"info",class:"mt-5"},{default:h((()=>t[5]||(t[5]=[D(" 添加后，应用上方的窗口控制器将被隐藏 ")]))),_:1})])),_:1},8,["title"])])),_:1},8,["show","width"])],64)}}}),re={class:"autoui-view mb-10"},ce={class:"mt-3"},de={class:"mb-3 px-4 sm:px-0"},pe={key:0,class:"mb-3 flex flex-wrap"},ue={class:"flex flex-wrap"},ge={class:"flex flex-wrap"},me=u({__name:"DotBlackListView",setup(u){const k=g(null),w=[{title:"应用名称",minWidth:250,key:"name",render:(e,t)=>x("div",null,[e.applicationName&&x("p",null,[e.applicationName]),e.name&&x("p",null,[x("span",{class:{hidden:!e.applicationName}},[D("(")]),e.name,x("span",{class:{hidden:!e.applicationName}},[D(")")])])])},{title:"规则状态",width:150,key:"isOptimizeWebView",render:(e,t)=>e.status?x(y("n-tag"),{bordered:!1,dashed:!0,type:"success"},{default:()=>[D("已生效")]}):x(y("n-tag"),{bordered:!1,dashed:!0,type:"info"},{default:()=>[D("未生效")]})},{title:"规则来源",width:150,key:"ruleMode",render(e,t){const a={icon:"custom"===e.ruleMode?oe:G};if("custom"===e.ruleMode){const t=[{label:"分享自定义规则",key:"shareCustomRule",icon:De(x("svg",{class:"icon","aria-hidden":"true"},[x("use",{"xlink:href":"#icon-fenxiang"},null)]),20)},{label:"清除自定义规则",key:"cleanCustomRule",icon:De(x("svg",{class:"icon","aria-hidden":"true"},[x("use",{"xlink:href":"#icon-qingchu"},null)]),20)}];return x(y("n-dropdown"),{onSelect:(t,a)=>(async(e,t,a)=>{if(ke.systemDotBlackList.length&&ke.hasHTMLViewerCloudData){if("cleanCustomRule"===e){const e=fe.create({title:"想清除自定义规则吗？",type:"warning",preset:"dialog",content:()=>x("p",null,[D("清除自定义规则后，将恢复")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(a.name,a.applicationName)])," ",D("的窗口控制器显示效果。确定要继续吗？")]),positiveText:"确定清除",negativeText:"我再想想",onPositiveClick:async()=>{e.loading=!0,ke.customDotBlackList=ke.customDotBlackList.filter((e=>e!==a.name)),ke.sourceDotBlackList=ke.sourceDotBlackList.map((e=>(e.dataList=e.dataList.filter((e=>e!==a.name)),e)));const t=ke.mergeDotBlackList.map((e=>e.name)),[l,n]=await z(I({dotBlackList:t,sourceDotBlackList:ke.sourceDotBlackList,customDotBlackList:ke.customDotBlackList}));l?(fe.create({title:"清除自定义规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，清除失败了QwQ，详细错误请查看错误日志~")])}),e.loading=!1):(e.loading=!1,fe.create({title:"清除自定义规则成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("好耶w，清除自定义规则成功了OwO~实际生效还需要重启")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("系统界面")])," ",D("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){N().then((async e=>{await Le(),fe.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})})).catch((e=>{fe.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})}))}}),e.loading=!1,await Le())}})}if("shareCustomRule"===e){const e={name:a.name,cmpt:1,rules:{name:a.name},type:"dot_black_list",device:"tablet"===b.deviceCharacteristics?"pad":"fold"},t=JSON.stringify(e),l=Y.deflate(t,{level:9,memLevel:9,windowBits:15}),n=new Uint8Array(l),o=X(n),[i]=await z(navigator.clipboard.writeText(`我分享了一个[窗口控制器]的自定义规则，可以前往[完美横屏应用计划 For Web UI]导入：\n${o}`));if(i)return void fe.create({title:"复制分享口令失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("复制")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(a.name,a.applicationName)])," ",D("的分享口令失败了QwQ，可能由于没有读取/写入剪切板的权限或")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("自定义规则")])," ",D("长度过大。")]),negativeText:"确定"});fe.create({title:"复制分享口令成功",type:"success",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("好耶w，复制")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(a.name,a.applicationName)])," ",D("分享口令成功了~")]),x("p",null,[D("如果没有复制成功，请确认是否给予了读取/写入剪切板的权限或")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("自定义规则")])," ",D("长度过大。")]),x("p",null,[D("分享口令导入入口位于")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("窗口控制器- 从分享口令导入")])," ",D("。")])]),positiveText:"确定"})}}else fe.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==b.currentRootManager&&x("p",null,[D("部分"),b.currentRootManager,D("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})})(t,0,e),size:"large",trigger:"click",options:t},{default:()=>[x(y("n-button"),{size:"small",dashed:!0,type:"info"},{default:()=>[D("自定义规则")],...a})]})}return x(y("n-button"),{size:"small",dashed:!0,type:"error",onClick:()=>(e=>{fe.create({title:"系统规则说明",type:"warning",preset:"dialog",content:()=>x("p",null,[D("系统已对")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(e.name,e.applicationName)])," ",D("配置了窗口控制器的隐藏，且不可被移除，仅有自定义规则可以被移除哦~")])})})(e)},{default:()=>[D("系统规则")],...a})}}],b=m(),M=O(),j=V(),me=f((()=>({theme:b.isDarkMode?F:J}))),{message:ve,modal:fe,notification:ye}=K(["message","modal","notification"],{configProviderProps:me}),ke=i(),we=g(!1),be=g(!1);S();const xe=g(null);s(),v(),r();const he=g("");function De(e,t){return()=>U(q,{size:t},{default:()=>U(e)})}const Le=async()=>{ke.systemDotBlackList.length&&ke.hasHTMLViewerCloudData?(await b.getAndroidApplicationPackageNameList(),await ke.initDefault()):fe.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==b.currentRootManager&&x("p",null,[D("部分"),b.currentRootManager,D("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})},Me=()=>{ke.filterInstalledApps=!ke.filterInstalledApps},Ce=async()=>{if(ke.systemDotBlackList.length&&ke.hasHTMLViewerCloudData){if(xe.value){const[e,t]=await z(xe.value.openDrawer());if(e)console.log("操作取消:",e);else{ke.customDotBlackList.push(t.name);const e=ke.mergeDotBlackList.map((e=>e.name)),[a,l]=await z(I({dotBlackList:e,sourceDotBlackList:ke.sourceDotBlackList,customDotBlackList:ke.customDotBlackList}));a?(fe.create({title:"应用添加失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，添加失败了QwQ，详细错误请查看错误日志~")])}),t.loadingCallback&&t.loadingCallback()):(fe.create({title:"应用添加成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("好耶w，已经成功配置")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(t.name,b.installedAppNameList[t.name]||ke.applicationName[t.name])])," ",D("的窗口控制器隐藏效果了OwO~实际生效还需要重启")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("系统界面")])," ",D("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){N().then((async e=>{await Le(),fe.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})})).catch((e=>{fe.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})}))}}),await Le(),t.loadingCallback&&t.loadingCallback(),t.closeCallback&&t.closeCallback())}}}else fe.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==b.currentRootManager&&x("p",null,[D("部分"),b.currentRootManager,D("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])})},_e=C({page:1,pageSize:10,simple:!0,showSizePicker:!0,onChange:e=>{_e.page=e},onUpdatePageSize:e=>{_e.pageSize=e,_e.page=1}});return(i,s)=>{const r=y("n-alert"),u=y("n-input-group"),g=y("n-card"),m=y("n-data-table");return c(),d("main",re,[p("div",ce,[p("div",de,[s[10]||(s[10]=p("h3",{class:_("text-base font-semibold leading-7")},[p("span",{class:"animated-bg bg-clip-text font-semibold text-transparent",style:{"background-image":"linear-gradient(\r\n\t\t\t\t\t\t\t\t101.22deg,\r\n\t\t\t\t\t\t\t\trgb(255, 182, 133) -18.32%,\r\n\t\t\t\t\t\t\t\trgb(255, 111, 29) 7.01%,\r\n\t\t\t\t\t\t\t\trgb(252, 181, 232) 41.59%,\r\n\t\t\t\t\t\t\t\trgb(135, 148, 255) 70.98%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 91.35%,\r\n\t\t\t\t\t\t\t\trgb(60, 112, 255) 110.17%\r\n\t\t\t\t\t\t\t)"}},"窗口控制器")],-1)),p("p",{class:_("mt-1 max-w-2xl text-sm leading-6 "+(L(b).isDarkMode?"text-gray-300":"text-gray-500"))}," 窗口控制器，控制应用顶栏窗口控制器的显示或隐藏。 ",2)])]),x(g,{size:"small"},{default:h((()=>[L(b).androidTargetSdk<35?(c(),d("div",pe,[x(r,{"show-icon":!0,type:"warning"},{default:h((()=>s[11]||(s[11]=[p("p",null,"经过测试效果在Hyper OS 1和基于Android 14的Hyper OS 2+体验不佳，极易被云控覆盖。",-1),p("p",null,"功能可以继续使用，但是不再对Hyper OS 1和基于Android 14的Hyper OS 2+下窗口控制器的缺陷和需求进行响应。",-1)]))),_:1})])):T("",!0),p("div",ue,[x(L(Z),{class:"mb-3 mr-3",type:"info",loading:L(b).loading||L(ke).loading,onClick:Ce},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(e))])),_:1})])),default:h((()=>[s[12]||(s[12]=D(" 添加应用 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",type:"success",loading:L(b).loading||L(ke).loading,onClick:s[0]||(s[0]=()=>Le())},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(t))])),_:1})])),default:h((()=>[s[13]||(s[13]=D(" 刷新应用列表 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",color:"#8a2be2",loading:L(b).loading||L(ke).loading,onClick:s[1]||(s[1]=()=>(async()=>{if(!ke.systemDotBlackList.length||!ke.hasHTMLViewerCloudData)return void fe.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==b.currentRootManager&&x("p",null,[D("部分"),b.currentRootManager,D("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])});be.value=!0,await Le();const e=ke.mergeDotBlackList.map((e=>e.name)),[t,a]=await z(I({dotBlackList:e,sourceDotBlackList:ke.sourceDotBlackList,customDotBlackList:ke.customDotBlackList}));t&&(fe.create({title:"热重载应用数据失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("热重载应用数据失败了QwQ，详情请查看错误日志~")]),negativeText:"确定"}),be.value=!1),a&&(fe.create({title:"热重载应用数据成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("好耶w，已经重新为你载入包括自定义规则在内的应用数据~实际生效还需要重启")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("系统界面")])," ",D("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){N().then((async e=>{await Le(),fe.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})})).catch((e=>{fe.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})}))}}),be.value=!1)})())},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(ee))])),_:1})])),default:h((()=>[s[14]||(s[14]=D(" 热重载应用数据 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",color:"#69b2b6",loading:L(b).loading||L(ke).loading||L(j).loading.value,onClick:s[2]||(s[2]=e=>(async()=>{const[e,t]=await z(j.getList());e&&fe.create({title:"获取失败",type:"warning",preset:"dialog",content:()=>x("p",null,[D("您的系统环境暂不支持该功能，获取失败~")]),negativeText:"确定"}),t&&fe.create({title:"获取成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("好耶OwO，已重新获取当前已安装的应用名称~")]),negativeText:"确定"})})())},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(te))])),_:1})])),default:h((()=>[s[15]||(s[15]=D(" 获取已安装应用名称 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",type:"warning",loading:L(b).loading||L(ke).loading||we.value,onClick:s[3]||(s[3]=e=>(async()=>{if(!ke.systemDotBlackList.length||!ke.hasHTMLViewerCloudData)return void fe.create({title:"获取云控失败",type:"error",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("无法获取到HTML查看器的云控，请检查是否禁用云控或者清除HTML查看器的数据再重启平板尝试操作~")]),"Magisk"!==b.currentRootManager&&x("p",null,[D("部分"),b.currentRootManager,D("版本内置的Web UI存在异常，如仍然无法正常获取云控数据库，请单独安装模块网盘内提供的KsuWebUI。")])])});he.value="";const[,e]=await z(new Promise(((e,t)=>{fe.create({title:"请粘贴分享口令",preset:"dialog",style:"min-width:500px; width:50%;",content:()=>U($,{type:"textarea",value:he.value,"onUpdate:value":e=>{he.value=e},autosize:{minRows:8,maxRows:8},placeholder:"在此处粘贴分享规则口令"}),positiveText:"确定提交",negativeText:"取消导入",onPositiveClick(){e("positiveClick")}})})));if(e){we.value=!0;const e=he.value,a=W(e);if(!(null==a?void 0:a.length))return fe.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("导入分享规则失败了QwQ，解析")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("自定义规则")])," ",D("口令发生错误，无法正常解析。")]),negativeText:"确定"}),void(we.value=!1);try{const e=E(a),t=Y.inflate(e,{to:"string"}),l=JSON.parse(t);if("dot_black_list"!==l.type)return fe.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("导入分享规则失败了QwQ，该")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("自定义规则")])," ",D("不适用于窗口控制器。")]),negativeText:"确定"}),void(we.value=!1);if("pad"===l.device&&"tablet"!==b.deviceCharacteristics||"fold"===l.device&&"tablet"===b.deviceCharacteristics)return fe.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("导入分享规则失败了QwQ，平板和折叠屏的适配规则不能混用哦~")]),negativeText:"确定"}),void(we.value=!1);if(ke.allPackageName.has(l.name))return fe.create({title:"应用包名已存在",type:"error",preset:"dialog",content:()=>x("p",null,[D("这个应用包名已经存在列表中了,导入分享规则失败了！（敲")])}),void(we.value=!1);ke.customDotBlackList.push(l.name);const n=ke.mergeDotBlackList.map((e=>e.name)),[o,i]=await z(I({dotBlackList:n,sourceDotBlackList:ke.sourceDotBlackList,customDotBlackList:ke.customDotBlackList}));o?(fe.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，导入失败了QwQ，详细错误请查看错误日志~")])}),we.value=!1):(await Le(),M.updateMergeRuleList(),we.value=!1,fe.create({title:"导入分享规则成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("好耶w，")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[A(l.name,b.installedAppNameList[l.name]||M.applicationName[l.name])])," ",D("的应用配置成功了OwO~实际生效还需要重启")," ",x("span",{class:"font-bold "+(b.isDarkMode?"text-teal-400":"text-gray-600")},[D("系统界面")])," ",D("的作用域，确定要继续吗？")]),positiveText:"确定重启作用域",negativeText:"稍后手动重启",onPositiveClick(){N().then((async e=>{await Le(),fe.create({title:"重启作用域成功",type:"success",preset:"dialog",content:()=>x("p",null,[D("已经成功为你重启系统界面的作用域，请查看是否生效，如不生效请手动重启平板再查看效果~")])})})).catch((e=>{fe.create({title:"重启作用域失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("发生异常错误，重启系统界面作用域失败QwQ，详细错误请查看日志~")])})}))}}))}catch(t){console.log(t,"error"),fe.create({title:"导入分享规则失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("解析分享规则失败了QwQ，请检查导入口令是否有误")]),negativeText:"确定"}),we.value=!1}}})())},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(ae))])),_:1})])),default:h((()=>[s[16]||(s[16]=D(" 从分享口令导入 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",type:"error",loading:L(b).loading||L(ke).loading||we.value,onClick:s[4]||(s[4]=e=>(async()=>{const[e,t]=await z(new Promise(((e,t)=>{fe.create({title:"想重启设备吗？",type:"info",preset:"dialog",content:()=>x("div",null,[x("p",null,[D("是否立即重启设备，以使规则生效？")])]),positiveText:"确认重启",negativeText:"取消",onPositiveClick:()=>{e("positiveClick")},onNegativeClick:()=>{t("negativeClick")}})})));if(t){const[e]=await z(R());if(e)return void fe.create({title:"操作失败",type:"error",preset:"dialog",content:()=>x("p",null,[D("无法重启设备，详情请查看日志记录~")]),negativeText:"确定"})}})())},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(ie))])),_:1})])),default:h((()=>[s[17]||(s[17]=D(" 重启设备 "))])),_:1},8,["loading"])]),p("div",ge,[x(L(Z),{class:"mb-3 mr-3",type:L(ke).filterInstalledApps?"success":"info",strong:"",loading:L(b).loading||L(ke).loading,secondary:"",onClick:Me},{icon:h((()=>[x(L(q),null,{default:h((()=>[L(ke).filterInstalledApps?(c(),B(L(le),{key:0})):(c(),B(L(ne),{key:1}))])),_:1})])),default:h((()=>[D(" "+Q(L(ke).filterInstalledApps?"已安装应用":"全部应用"),1)])),_:1},8,["type","loading"]),x(L(Z),{class:"mb-3 mr-3",type:"warning",secondary:"",loading:L(b).loading||L(ke).loading,onClick:s[5]||(s[5]=()=>H())},{icon:h((()=>[x(L(q),null,{default:h((()=>s[18]||(s[18]=[p("img",{src:a},null,-1)]))),_:1})])),default:h((()=>[s[19]||(s[19]=D(" 应用抽屉 "))])),_:1},8,["loading"]),x(L(Z),{class:"mb-3 mr-3",type:"error",secondary:"",loading:L(b).loading||L(ke).loading,onClick:s[6]||(s[6]=()=>P())},{icon:h((()=>[x(L(q),null,{default:h((()=>s[20]||(s[20]=[p("img",{src:o},null,-1)]))),_:1})])),default:h((()=>[s[21]||(s[21]=D(" 超级小爱 "))])),_:1},8,["loading"])]),x(u,null,{default:h((()=>[x(L($),{size:"large",clearable:"",value:L(ke).searchKeyWord,"onUpdate:value":s[7]||(s[7]=e=>L(ke).searchKeyWord=e),ref_key:"searchKeyWordInput",ref:k,placeholder:"搜索应用名称/应用包名",autosize:"",style:{width:"80%"}},null,8,["value"]),x(L(Z),{size:"large",type:"primary",onClick:s[8]||(s[8]=()=>{var e;null==(e=k.value)||e.blur()})},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(l))])),_:1})])),default:h((()=>[s[22]||(s[22]=D(" 搜索 "))])),_:1}),x(L(Z),{size:"large",bordered:"",onClick:s[9]||(s[9]=()=>{L(ke).searchKeyWord=""})},{icon:h((()=>[x(L(q),null,{default:h((()=>[x(L(n))])),_:1})])),default:h((()=>[s[23]||(s[23]=D(" 清空 "))])),_:1})])),_:1})])),_:1}),x(m,{size:"small",loading:L(b).loading||L(ke).loading,columns:L(w),class:"mt-3",data:L(ke).filterMergeDotBlackList,pagination:_e},null,8,["loading","columns","data","pagination"]),x(se,{ref_key:"addDotBlackListApp",ref:xe,type:"add",title:"添加应用"},null,512)])}}});export{me as default};
